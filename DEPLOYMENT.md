# 🚀 Full Serverless Deployment Guide\n\n## Netlify + Supabase Architecture\n\nThis guide will help you deploy the Fantasy Crypto platform using:\n- **Frontend**: Netlify (Static hosting + Functions)\n- **Database**: Supabase (PostgreSQL + Real-time)\n- **Authentication**: Supabase Auth\n- **Smart Contracts**: Arbitrum\n\n---\n\n## 📋 Prerequisites\n\n- GitHub account\n- Netlify account\n- Supabase account  \n- MetaMask wallet\n- Reown (WalletConnect) account\n\n---\n\n## 🔧 Step 1: Setup Supabase\n\n### 1.1 Create Supabase Project\n1. Go to [supabase.com](https://supabase.com)\n2. Click \"Start your project\" → \"New Project\"\n3. Choose organization → Create project\n4. Wait for setup to complete (~2 minutes)\n\n### 1.2 Setup Database\n1. Go to **SQL Editor** in your Supabase dashboard\n2. Click \"New Query\"\n3. Copy the entire contents of `supabase/migrations/001_initial_schema.sql`\n4. Paste and click **\"Run\"**\n5. Verify tables are created in **Table Editor**\n\n### 1.3 Configure Authentication\n1. Go to **Authentication** → **Settings**\n2. Under **Site URL**, add your Netlify domain (you'll get this later)\n3. Under **Auth Providers**, disable email (we'll use custom wallet auth)\n4. Copy your **Project URL** and **anon public key**\n\n---\n\n## 🌐 Step 2: Setup Netlify\n\n### 2.1 Deploy to Netlify\n1. Go to [netlify.com](https://netlify.com)\n2. Click \"Add new site\" → \"Import an existing project\"\n3. Connect to GitHub and select your `fantasy-crypto` repository\n4. Configure build settings:\n   - **Build command**: `npm run build`\n   - **Publish directory**: `.next`\n   - **Functions directory**: `netlify/functions`\n\n### 2.2 Environment Variables\nIn Netlify dashboard → Site settings → Environment variables, add:\n\n```env\n# Supabase\nNEXT_PUBLIC_SUPABASE_URL=your-supabase-project-url\nNEXT_PUBLIC_SUPABASE_ANON_KEY=your-supabase-anon-key\nSUPABASE_SERVICE_ROLE_KEY=your-service-role-key\n\n# Wallet Connect\nNEXT_PUBLIC_REOWN_PROJECT_ID=your-reown-project-id\n\n# API Configuration\nNEXT_PUBLIC_API_URL=https://your-site-name.netlify.app/.netlify/functions\n```\n\n### 2.3 Get Your Service Role Key\n1. In Supabase dashboard → Settings → API\n2. Copy the **service_role** key (keep this secret!)\n3. Add it to Netlify environment variables\n\n---\n\n## 🔗 Step 3: Setup Wallet Integration\n\n### 3.1 Create Reown Project\n1. Go to [cloud.reown.com](https://cloud.reown.com)\n2. Create new project\n3. Copy your **Project ID**\n4. Add it to Netlify environment variables\n\n### 3.2 Configure Wallet Settings\n1. In Reown dashboard, add your Netlify domain to allowed origins\n2. Configure supported wallets (MetaMask, Phantom, etc.)\n\n---\n\n## 💰 Step 4: Deploy Smart Contracts\n\n### 4.1 Setup Deployment Environment\n```bash\n# Clone your repo locally\ngit clone https://github.com/YOUR_USERNAME/fantasy-crypto.git\ncd fantasy-crypto\n\n# Install dependencies\nnpm install\n\n# Create .env file\ncp api.conf .env\n```\n\n### 4.2 Configure Environment\nEdit `.env` file:\n```env\nPRIVATE_KEY=your-wallet-private-key\nARBITRUM_RPC_URL=https://arb1.arbitrum.io/rpc\nARBISCAN_API_KEY=your-arbiscan-api-key\nTREASURY_ADDRESS=your-treasury-wallet-address\nINSURANCE_ADDRESS=your-insurance-wallet-address\n```\n\n### 4.3 Deploy Contracts\n```bash\n# Compile contracts\nnpx hardhat compile\n\n# Deploy to Arbitrum\nnpx hardhat run contracts/deployment/deploy.js --network arbitrum\n```\n\n### 4.4 Update Configuration\n1. Copy the deployed contract addresses\n2. Add them to Netlify environment variables:\n   - `NEXT_PUBLIC_UNITE_TOKEN_ADDRESS`\n   - `NEXT_PUBLIC_FANTASY_CRYPTO_ADDRESS`\n\n---\n\n## 🔄 Step 5: Configure Real-time Features\n\n### 5.1 Enable Supabase Realtime\n1. In Supabase dashboard → Database → Replication\n2. Enable replication for these tables:\n   - `matches`\n   - `users` \n   - `coins`\n   - `leaderboard_view`\n\n### 5.2 Test Real-time\nThe platform automatically subscribes to:\n- Match updates\n- Leaderboard changes\n- Coin price updates\n\n---\n\n## 🧪 Step 6: Testing\n\n### 6.1 Frontend Testing\n1. Visit your Netlify URL\n2. Connect wallet\n3. Verify user creation in Supabase\n4. Test navigation and UI\n\n### 6.2 API Testing\nTest your Netlify Functions:\n```bash\n# Test auth endpoint\ncurl https://your-site.netlify.app/.netlify/functions/auth/user/0x...\n\n# Test leaderboard\ncurl https://your-site.netlify.app/.netlify/functions/leaderboard\n\n# Test trading data\ncurl https://your-site.netlify.app/.netlify/functions/trading/coins\n```\n\n### 6.3 Database Testing\n1. Check Supabase Table Editor\n2. Verify Row Level Security policies\n3. Test real-time subscriptions\n\n---\n\n## 🔒 Step 7: Security & Production\n\n### 7.1 Row Level Security\n- ✅ Already configured in schema\n- ✅ Users can only access their own data\n- ✅ Public data is read-only\n\n### 7.2 Environment Security\n- ✅ Service role key is server-side only\n- ✅ Public keys are properly scoped\n- ✅ Smart contracts are audited\n\n### 7.3 Performance Optimization\n- ✅ Database indexes in place\n- ✅ Netlify CDN for static assets\n- ✅ Supabase connection pooling\n\n---\n\n## 🚀 Step 8: Go Live!\n\n### 8.1 Final Checklist\n- [ ] Supabase database setup complete\n- [ ] Netlify deployment successful\n- [ ] Environment variables configured\n- [ ] Smart contracts deployed\n- [ ] Wallet integration working\n- [ ] Real-time features enabled\n- [ ] API endpoints responding\n\n### 8.2 Custom Domain (Optional)\n1. In Netlify → Domain management → Add custom domain\n2. Update Supabase site URL to your custom domain\n3. Update Reown project settings\n\n### 8.3 Monitoring\n- **Netlify**: Functions logs and analytics\n- **Supabase**: Database monitoring and logs  \n- **Arbitrum**: Contract interaction monitoring\n\n---\n\n## 🆘 Troubleshooting\n\n### Common Issues:\n\n**❌ \"Function not found\" errors**\n- Check Netlify Functions directory is correct\n- Verify build completed successfully\n- Check function syntax and exports\n\n**❌ Database connection errors**\n- Verify Supabase environment variables\n- Check RLS policies aren't blocking access\n- Confirm service role key is correct\n\n**❌ Wallet connection fails** \n- Check Reown project ID\n- Verify domain is whitelisted\n- Confirm network configuration (Arbitrum)\n\n**❌ Real-time not working**\n- Enable replication in Supabase\n- Check WebSocket connection\n- Verify subscription permissions\n\n---\n\n## 📞 Support\n\nIf you encounter issues:\n1. Check the [GitHub Issues](https://github.com/obsanitylabs/fantasy-crypto/issues)\n2. Review Netlify Function logs\n3. Check Supabase logs and monitoring\n4. Verify all environment variables are set\n\n---\n\n## 🎉 Success!\n\nYour Fantasy Crypto platform is now live with:\n- ✅ Serverless architecture\n- ✅ Real-time updates\n- ✅ Secure authentication\n- ✅ Global CDN distribution\n- ✅ Automatic scaling\n- ✅ Zero server maintenance\n\n**Your platform is ready for traders! 🏈💰**"